%a=0; b=0;
%6x15 = 90 eigenvalues
%there are 7 infinite eigenvalues, which can be removed.
%Mat0 has two zero-eigenvalue

function [ftemp ttemp] = PnP_f_Solver_NEW_t(a,b)
  %vec1 = [ f^5*t1^8, f^5*t1^7, f^5*t1^6, f^5*t1^5, f^5*t1^4, f^5*t1^3, f^5*t1^2, f^5*t1, f^5, f^4*t1^8, f^4*t1^7, f^4*t1^6, f^4*t1^5, f^4*t1^4, f^4*t1^3, f^4*t1^2, f^4*t1, f^4, f^3*t1^8, f^3*t1^7, f^3*t1^6, f^3*t1^5, f^3*t1^4, f^3*t1^3, f^3*t1^2, f^3*t1, f^3, f^2*t1^8, f^2*t1^7, f^2*t1^6, f^2*t1^5, f^2*t1^4, f^2*t1^3, f^2*t1^2, f^2*t1, f^2, f*t1^8, f*t1^7, f*t1^6, f*t1^5, f*t1^4, f*t1^3, f*t1^2, f*t1, f, t1^8, t1^7, t1^6, t1^5, t1^4, t1^3, t1^2, t1, 1]
  %vec2 = [ f^6*t1^7, f^6*t1^6, f^6*t1^5, f^6*t1^4, f^6*t1^3, f^6*t1^2, f^6*t1, f^6, f^5*t1^7, f^5*t1^6, f^5*t1^5, f^5*t1^4, f^5*t1^3, f^5*t1^2, f^5*t1, f^5, f^4*t1^7, f^4*t1^6, f^4*t1^5, f^4*t1^4, f^4*t1^3, f^4*t1^2, f^4*t1, f^4, f^3*t1^7, f^3*t1^6, f^3*t1^5, f^3*t1^4, f^3*t1^3, f^3*t1^2, f^3*t1, f^3, f^2*t1^7, f^2*t1^6, f^2*t1^5, f^2*t1^4, f^2*t1^3, f^2*t1^2, f^2*t1, f^2, f*t1^7, f*t1^6, f*t1^5, f*t1^4, f*t1^3, f*t1^2, f*t1, f, t1^7, t1^6, t1^5, t1^4, t1^3, t1^2, t1, 1]
    a1 =  a(1);  a2 =  a(2);  a3 =  a(3);  a4 =  a(4);  a5 =  a(5);  a6 =  a(6);  a7 =  a(7);  a8 =  a(8);  a9 =  a(9);  a10 = a(10);
    a11 = a(11); a12 = a(12); a13 = a(13); a14 = a(14); a15 = a(15); a16 = a(16); a17 = a(17); a18 = a(18); a19 = a(19); a20 = a(20);
    a21 = a(21); a22 = a(22); a23 = a(23); a24 = a(24); a25 = a(25); a26 = a(26); a27 = a(27); a28 = a(28); a29 = a(29); a30 = a(30);
    a31 = a(31); a32 = a(32); a33 = a(33); a34 = a(34); a35 = a(35); a36 = a(36); a37 = a(37); a38 = a(38); a39 = a(39); a40 = a(40);
    a41 = a(41); a42 = a(42); a43 = a(43); a44 = a(44); a45 = a(45); a46 = a(46); a47 = a(47); a48 = a(48); a49 = a(49); a50 = a(50);
    a51 = a(51); a52 = a(52); a53 = a(53); a54 = a(54); 
    
    b1 =  b(1);  b2 =  b(2);  b3 =  b(3);  b4 =  b(4);  b5 =  b(5);  b6 =  b(6);  b7 =  b(7);  b8 =  b(8);  b9 =  b(9);  b10 = b(10);
    b11 = b(11); b12 = b(12); b13 = b(13); b14 = b(14); b15 = b(15); b16 = b(16); b17 = b(17); b18 = b(18); b19 = b(19); b20 = b(20);
    b21 = b(21); b22 = b(22); b23 = b(23); b24 = b(24); b25 = b(25); b26 = b(26); b27 = b(27); b28 = b(28); b29 = b(29); b30 = b(30);
    b31 = b(31); b32 = b(32); b33 = b(33); b34 = b(34); b35 = b(35); b36 = b(36); b37 = b(37); b38 = b(38); b39 = b(39); b40 = b(40);
    b41 = b(41); b42 = b(42); b43 = b(43); b44 = b(44); b45 = b(45); b46 = b(46); b47 = b(47); b48 = b(48); b49 = b(49); b50 = b(50);
    b51 = b(51); b52 = b(52); b53 = b(53); b54 = b(54); b55 = b(55); b56 = b(56);
  
Mat0 = [[  a9,   0,   0,   0,   0,   0,  b8,   0,   0,   0,   0]
[ a18,  a9,   0,   0,   0,   0, b16,  b8,   0,   0,   0]
[ a27, a18,  a9,   0,   0,   0, b24, b16,  b8,   0,   0]
[ a36, a27, a18,  a9,   0,   0, b32, b24, b16,  b8,   0]
[ a45, a36, a27, a18,  a9,   0, b40, b32, b24, b16,  b8]
[ a54, a45, a36, a27, a18,  a9, b48, b40, b32, b24, b16]
[   0, a54, a45, a36, a27, a18, b56, b48, b40, b32, b24]
[   0,   0, a54, a45, a36, a27,   0, b56, b48, b40, b32]
[   0,   0,   0, a54, a45, a36,   0,   0, b56, b48, b40]
[   0,   0,   0,   0, a54, a45,   0,   0,   0, b56, b48]
[   0,   0,   0,   0,   0, a54,   0,   0,   0,   0, b56]];
 
 
Mat1 = [[  a8,   0,   0,   0,   0,   0,  b7,   0,   0,   0,   0]
[ a17,  a8,   0,   0,   0,   0, b15,  b7,   0,   0,   0]
[ a26, a17,  a8,   0,   0,   0, b23, b15,  b7,   0,   0]
[ a35, a26, a17,  a8,   0,   0, b31, b23, b15,  b7,   0]
[ a44, a35, a26, a17,  a8,   0, b39, b31, b23, b15,  b7]
[ a53, a44, a35, a26, a17,  a8, b47, b39, b31, b23, b15]
[   0, a53, a44, a35, a26, a17, b55, b47, b39, b31, b23]
[   0,   0, a53, a44, a35, a26,   0, b55, b47, b39, b31]
[   0,   0,   0, a53, a44, a35,   0,   0, b55, b47, b39]
[   0,   0,   0,   0, a53, a44,   0,   0,   0, b55, b47]
[   0,   0,   0,   0,   0, a53,   0,   0,   0,   0, b55]];
 
 
Mat2 = [[  a7,   0,   0,   0,   0,   0,  b6,   0,   0,   0,   0]
[ a16,  a7,   0,   0,   0,   0, b14,  b6,   0,   0,   0]
[ a25, a16,  a7,   0,   0,   0, b22, b14,  b6,   0,   0]
[ a34, a25, a16,  a7,   0,   0, b30, b22, b14,  b6,   0]
[ a43, a34, a25, a16,  a7,   0, b38, b30, b22, b14,  b6]
[ a52, a43, a34, a25, a16,  a7, b46, b38, b30, b22, b14]
[   0, a52, a43, a34, a25, a16, b54, b46, b38, b30, b22]
[   0,   0, a52, a43, a34, a25,   0, b54, b46, b38, b30]
[   0,   0,   0, a52, a43, a34,   0,   0, b54, b46, b38]
[   0,   0,   0,   0, a52, a43,   0,   0,   0, b54, b46]
[   0,   0,   0,   0,   0, a52,   0,   0,   0,   0, b54]];
 
 
Mat3 = [[  a6,   0,   0,   0,   0,   0,  b5,   0,   0,   0,   0]
[ a15,  a6,   0,   0,   0,   0, b13,  b5,   0,   0,   0]
[ a24, a15,  a6,   0,   0,   0, b21, b13,  b5,   0,   0]
[ a33, a24, a15,  a6,   0,   0, b29, b21, b13,  b5,   0]
[ a42, a33, a24, a15,  a6,   0, b37, b29, b21, b13,  b5]
[ a51, a42, a33, a24, a15,  a6, b45, b37, b29, b21, b13]
[   0, a51, a42, a33, a24, a15, b53, b45, b37, b29, b21]
[   0,   0, a51, a42, a33, a24,   0, b53, b45, b37, b29]
[   0,   0,   0, a51, a42, a33,   0,   0, b53, b45, b37]
[   0,   0,   0,   0, a51, a42,   0,   0,   0, b53, b45]
[   0,   0,   0,   0,   0, a51,   0,   0,   0,   0, b53]];
 
 
Mat4 = [[  a5,   0,   0,   0,   0,   0,  b4,   0,   0,   0,   0]
[ a14,  a5,   0,   0,   0,   0, b12,  b4,   0,   0,   0]
[ a23, a14,  a5,   0,   0,   0, b20, b12,  b4,   0,   0]
[ a32, a23, a14,  a5,   0,   0, b28, b20, b12,  b4,   0]
[ a41, a32, a23, a14,  a5,   0, b36, b28, b20, b12,  b4]
[ a50, a41, a32, a23, a14,  a5, b44, b36, b28, b20, b12]
[   0, a50, a41, a32, a23, a14, b52, b44, b36, b28, b20]
[   0,   0, a50, a41, a32, a23,   0, b52, b44, b36, b28]
[   0,   0,   0, a50, a41, a32,   0,   0, b52, b44, b36]
[   0,   0,   0,   0, a50, a41,   0,   0,   0, b52, b44]
[   0,   0,   0,   0,   0, a50,   0,   0,   0,   0, b52]];
 
 
Mat5 = [[  a4,   0,   0,   0,   0,   0,  b3,   0,   0,   0,   0]
[ a13,  a4,   0,   0,   0,   0, b11,  b3,   0,   0,   0]
[ a22, a13,  a4,   0,   0,   0, b19, b11,  b3,   0,   0]
[ a31, a22, a13,  a4,   0,   0, b27, b19, b11,  b3,   0]
[ a40, a31, a22, a13,  a4,   0, b35, b27, b19, b11,  b3]
[ a49, a40, a31, a22, a13,  a4, b43, b35, b27, b19, b11]
[   0, a49, a40, a31, a22, a13, b51, b43, b35, b27, b19]
[   0,   0, a49, a40, a31, a22,   0, b51, b43, b35, b27]
[   0,   0,   0, a49, a40, a31,   0,   0, b51, b43, b35]
[   0,   0,   0,   0, a49, a40,   0,   0,   0, b51, b43]
[   0,   0,   0,   0,   0, a49,   0,   0,   0,   0, b51]];
 
 
Mat6 = [[  a3,   0,   0,   0,   0,   0,  b2,   0,   0,   0,   0]
[ a12,  a3,   0,   0,   0,   0, b10,  b2,   0,   0,   0]
[ a21, a12,  a3,   0,   0,   0, b18, b10,  b2,   0,   0]
[ a30, a21, a12,  a3,   0,   0, b26, b18, b10,  b2,   0]
[ a39, a30, a21, a12,  a3,   0, b34, b26, b18, b10,  b2]
[ a48, a39, a30, a21, a12,  a3, b42, b34, b26, b18, b10]
[   0, a48, a39, a30, a21, a12, b50, b42, b34, b26, b18]
[   0,   0, a48, a39, a30, a21,   0, b50, b42, b34, b26]
[   0,   0,   0, a48, a39, a30,   0,   0, b50, b42, b34]
[   0,   0,   0,   0, a48, a39,   0,   0,   0, b50, b42]
[   0,   0,   0,   0,   0, a48,   0,   0,   0,   0, b50]];
 
 
Mat7 = [[  a2,   0,   0,   0,   0,   0,  b1,   0,   0,   0,   0]
[ a11,  a2,   0,   0,   0,   0,  b9,  b1,   0,   0,   0]
[ a20, a11,  a2,   0,   0,   0, b17,  b9,  b1,   0,   0]
[ a29, a20, a11,  a2,   0,   0, b25, b17,  b9,  b1,   0]
[ a38, a29, a20, a11,  a2,   0, b33, b25, b17,  b9,  b1]
[ a47, a38, a29, a20, a11,  a2, b41, b33, b25, b17,  b9]
[   0, a47, a38, a29, a20, a11, b49, b41, b33, b25, b17]
[   0,   0, a47, a38, a29, a20,   0, b49, b41, b33, b25]
[   0,   0,   0, a47, a38, a29,   0,   0, b49, b41, b33]
[   0,   0,   0,   0, a47, a38,   0,   0,   0, b49, b41]
[   0,   0,   0,   0,   0, a47,   0,   0,   0,   0, b49]];
 
 
Mat8 = [[  a1,   0,   0,   0,   0,   0, 0, 0, 0, 0, 0]
[ a10,  a1,   0,   0,   0,   0, 0, 0, 0, 0, 0]
[ a19, a10,  a1,   0,   0,   0, 0, 0, 0, 0, 0]
[ a28, a19, a10,  a1,   0,   0, 0, 0, 0, 0, 0]
[ a37, a28, a19, a10,  a1,   0, 0, 0, 0, 0, 0]
[ a46, a37, a28, a19, a10,  a1, 0, 0, 0, 0, 0]
[   0, a46, a37, a28, a19, a10, 0, 0, 0, 0, 0]
[   0,   0, a46, a37, a28, a19, 0, 0, 0, 0, 0]
[   0,   0,   0, a46, a37, a28, 0, 0, 0, 0, 0]
[   0,   0,   0,   0, a46, a37, 0, 0, 0, 0, 0]
[   0,   0,   0,   0,   0, a46, 0, 0, 0, 0, 0]];

% %polynomial eigenvalue factorization
% [X] = polyeig(Mat0,Mat1,Mat2,Mat3,Mat4,Mat5,Mat6);
% 
% %find the real eigenvalue
% I = find(not(imag(X)));
% ftemp = X(I);
% 

Mat{1} = Mat1; Mat{2} = Mat2; Mat{3} = Mat3; Mat{4} = Mat4;
Mat{5} = Mat5; Mat{6} = Mat6; Mat{7} = Mat7; Mat{8} = Mat8; 

A = eye(11*8);
A(1:11,1:11) = Mat0;
B = diag(ones(11*(8-1),1),-11);
j = 1:11;
for k = 1:8
    B(1:11,j) = - Mat{k};
    j = j+11;
end
% XX = eig(A,B);
% %find the real eigenvalue
% I = find(not(imag(XX)));
% ftemp2 = XX(I);
% 

AA = A([1:83],[1:83]); BB = B([1:83],[1:83]);
[YYY XXX] = eig(AA.',BB.');
%find the real eigenvalue
XXX = diag(XXX);
I = find(abs(imag(XXX))<1e-6);
ttemp = real(XXX(I));
YYY = real(YYY(:,I));
YYY = YYY(1:9,:)./YYY(2:10,:);
ftemp = median(YYY,1)';

% t in the interval [0.1,100]
% f in the interval [0.1,1000]
Index = (ttemp>0.1).*(ttemp<100).*(ftemp>0.1).*(ftemp<1000);

ttemp = ttemp(Index>0.5);
ftemp = ftemp(Index>0.5);
end
