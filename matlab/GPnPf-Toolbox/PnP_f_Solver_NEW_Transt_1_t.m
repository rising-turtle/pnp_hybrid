%a*vec1=0; b*vec2=0;
%6x15 = 90 eigenvalues
%there are 7 infinite eigenvalues, which can be removed.

function [ftemp ttemp] = PnP_f_Solver_NEW_Transt_1_t(a,b)
%vec1 = [ f^5*t1^8, f^4*t1^8, f^4*t1^7, f^4*t1^6, f^3*t1^8, f^3*t1^7, f^3*t1^6, f^3*t1^5, f^3*t1^4, f^2*t1^8, f^2*t1^7, f^2*t1^6, f^2*t1^5, f^2*t1^4, f^2*t1^3, f^2*t1^2, f*t1^8, f*t1^7, f*t1^6, f*t1^5, f*t1^4, f*t1^3, f*t1^2, f*t1, f, t1^8, t1^7, t1^6, t1^5, t1^4, t1^3, t1^2, t1, 1]
%vec2 = [ f^6*t1^7, f^5*t1^7, f^5*t1^6, f^5*t1^5, f^4*t1^7, f^4*t1^6, f^4*t1^5, f^4*t1^4, f^4*t1^3, f^3*t1^7, f^3*t1^6, f^3*t1^5, f^3*t1^4, f^3*t1^3, f^3*t1^2, f^3*t1, f^2*t1^7, f^2*t1^6, f^2*t1^5, f^2*t1^4, f^2*t1^3, f^2*t1^2, f^2*t1, f^2, f*t1^7, f*t1^6, f*t1^5, f*t1^4, f*t1^3, f*t1^2, f*t1, f, t1^7, t1^6, t1^5, t1^4, t1^3, t1^2, t1, 1]
a1 =  a(1);  a2 =  a(2);  a3 =  a(3);  a4 =  a(4);  a5 =  a(5);  a6 =  a(6);  a7 =  a(7);  a8 =  a(8);  a9 =  a(9);  a10 = a(10);
a11 = a(11); a12 = a(12); a13 = a(13); a14 = a(14); a15 = a(15); a16 = a(16); a17 = a(17); a18 = a(18); a19 = a(19); a20 = a(20);
a21 = a(21); a22 = a(22); a23 = a(23); a24 = a(24); a25 = a(25); a26 = a(26); a27 = a(27); a28 = a(28); a29 = a(29); a30 = a(30);
a31 = a(31); a32 = a(32); a33 = a(33); a34 = a(34); 

b1 =  b(1);  b2 =  b(2);  b3 =  b(3);  b4 =  b(4);  b5 =  b(5);  b6 =  b(6);  b7 =  b(7);  b8 =  b(8);  b9 =  b(9);  b10 = b(10);
b11 = b(11); b12 = b(12); b13 = b(13); b14 = b(14); b15 = b(15); b16 = b(16); b17 = b(17); b18 = b(18); b19 = b(19); b20 = b(20);
b21 = b(21); b22 = b(22); b23 = b(23); b24 = b(24); b25 = b(25); b26 = b(26); b27 = b(27); b28 = b(28); b29 = b(29); b30 = b(30);
b31 = b(31); b32 = b(32); b33 = b(33); b34 = b(34); b35 = b(35); b36 = b(36); b37 = b(37); b38 = b(38); b39 = b(39); b40 = b(40);
  
Mat0 = [[ 0, 0, 0, 0, a25, a34,   0,   0,   0,   0,   0]
        [ 0, 0, 0, 0,   0, a25, a34,   0,   0,   0,   0]
        [ 0, 0, 0, 0,   0,   0, a25, a34,   0,   0,   0]
        [ 0, 0, 0, 0,   0,   0,   0, a25, a34,   0,   0]
        [ 0, 0, 0, 0,   0,   0,   0,   0, a25, a34,   0]
        [ 0, 0, 0, 0,   0,   0,   0,   0,   0, a25, a34]
        [ 0, 0, 0, 0, b24, b32, b40,   0,   0,   0,   0]
        [ 0, 0, 0, 0,   0, b24, b32, b40,   0,   0,   0]
        [ 0, 0, 0, 0,   0,   0, b24, b32, b40,   0,   0]
        [ 0, 0, 0, 0,   0,   0,   0, b24, b32, b40,   0]
        [ 0, 0, 0, 0,   0,   0,   0,   0, b24, b32, b40]]';
 
 
Mat1 = [[ 0, 0, 0,   0, a24, a33,   0,   0,   0,   0,   0]
        [ 0, 0, 0,   0,   0, a24, a33,   0,   0,   0,   0]
        [ 0, 0, 0,   0,   0,   0, a24, a33,   0,   0,   0]
        [ 0, 0, 0,   0,   0,   0,   0, a24, a33,   0,   0]
        [ 0, 0, 0,   0,   0,   0,   0,   0, a24, a33,   0]
        [ 0, 0, 0,   0,   0,   0,   0,   0,   0, a24, a33]
        [ 0, 0, 0, b16, b23, b31, b39,   0,   0,   0,   0]
        [ 0, 0, 0,   0, b16, b23, b31, b39,   0,   0,   0]
        [ 0, 0, 0,   0,   0, b16, b23, b31, b39,   0,   0]
        [ 0, 0, 0,   0,   0,   0, b16, b23, b31, b39,   0]
        [ 0, 0, 0,   0,   0,   0,   0, b16, b23, b31, b39]]';

 
Mat2 = [[ 0, 0, 0, a16, a23, a32,   0,   0,   0,   0,   0]
        [ 0, 0, 0,   0, a16, a23, a32,   0,   0,   0,   0]
        [ 0, 0, 0,   0,   0, a16, a23, a32,   0,   0,   0]
        [ 0, 0, 0,   0,   0,   0, a16, a23, a32,   0,   0]
        [ 0, 0, 0,   0,   0,   0,   0, a16, a23, a32,   0]
        [ 0, 0, 0,   0,   0,   0,   0,   0, a16, a23, a32]
        [ 0, 0, 0, b15, b22, b30, b38,   0,   0,   0,   0]
        [ 0, 0, 0,   0, b15, b22, b30, b38,   0,   0,   0]
        [ 0, 0, 0,   0,   0, b15, b22, b30, b38,   0,   0]
        [ 0, 0, 0,   0,   0,   0, b15, b22, b30, b38,   0]
        [ 0, 0, 0,   0,   0,   0,   0, b15, b22, b30, b38]]';
 
 
Mat3 = [[ 0, 0,  0, a15, a22, a31,   0,   0,   0,   0,   0]
        [ 0, 0,  0,   0, a15, a22, a31,   0,   0,   0,   0]
        [ 0, 0,  0,   0,   0, a15, a22, a31,   0,   0,   0]
        [ 0, 0,  0,   0,   0,   0, a15, a22, a31,   0,   0]
        [ 0, 0,  0,   0,   0,   0,   0, a15, a22, a31,   0]
        [ 0, 0,  0,   0,   0,   0,   0,   0, a15, a22, a31]
        [ 0, 0, b9, b14, b21, b29, b37,   0,   0,   0,   0]
        [ 0, 0,  0,  b9, b14, b21, b29, b37,   0,   0,   0]
        [ 0, 0,  0,   0,  b9, b14, b21, b29, b37,   0,   0]
        [ 0, 0,  0,   0,   0,  b9, b14, b21, b29, b37,   0]
        [ 0, 0,  0,   0,   0,   0,  b9, b14, b21, b29, b37]]';
 
 
Mat4 = [[ 0, 0, a9, a14, a21, a30,   0,   0,   0,   0,   0]
        [ 0, 0,  0,  a9, a14, a21, a30,   0,   0,   0,   0]
        [ 0, 0,  0,   0,  a9, a14, a21, a30,   0,   0,   0]
        [ 0, 0,  0,   0,   0,  a9, a14, a21, a30,   0,   0]
        [ 0, 0,  0,   0,   0,   0,  a9, a14, a21, a30,   0]
        [ 0, 0,  0,   0,   0,   0,   0,  a9, a14, a21, a30]
        [ 0, 0, b8, b13, b20, b28, b36,   0,   0,   0,   0]
        [ 0, 0,  0,  b8, b13, b20, b28, b36,   0,   0,   0]
        [ 0, 0,  0,   0,  b8, b13, b20, b28, b36,   0,   0]
        [ 0, 0,  0,   0,   0,  b8, b13, b20, b28, b36,   0]
        [ 0, 0,  0,   0,   0,   0,  b8, b13, b20, b28, b36]]';
 
 
Mat5 = [[ 0,  0, a8, a13, a20, a29,   0,   0,   0,   0,   0]
        [ 0,  0,  0,  a8, a13, a20, a29,   0,   0,   0,   0]
        [ 0,  0,  0,   0,  a8, a13, a20, a29,   0,   0,   0]
        [ 0,  0,  0,   0,   0,  a8, a13, a20, a29,   0,   0]
        [ 0,  0,  0,   0,   0,   0,  a8, a13, a20, a29,   0]
        [ 0,  0,  0,   0,   0,   0,   0,  a8, a13, a20, a29]
        [ 0, b4, b7, b12, b19, b27, b35,   0,   0,   0,   0]
        [ 0,  0, b4,  b7, b12, b19, b27, b35,   0,   0,   0]
        [ 0,  0,  0,  b4,  b7, b12, b19, b27, b35,   0,   0]
        [ 0,  0,  0,   0,  b4,  b7, b12, b19, b27, b35,   0]
        [ 0,  0,  0,   0,   0,  b4,  b7, b12, b19, b27, b35]]';
 
 
Mat6 = [[ 0, a4, a7, a12, a19, a28,   0,   0,   0,   0,   0]
        [ 0,  0, a4,  a7, a12, a19, a28,   0,   0,   0,   0]
        [ 0,  0,  0,  a4,  a7, a12, a19, a28,   0,   0,   0]
        [ 0,  0,  0,   0,  a4,  a7, a12, a19, a28,   0,   0]
        [ 0,  0,  0,   0,   0,  a4,  a7, a12, a19, a28,   0]
        [ 0,  0,  0,   0,   0,   0,  a4,  a7, a12, a19, a28]
        [ 0, b3, b6, b11, b18, b26, b34,   0,   0,   0,   0]
        [ 0,  0, b3,  b6, b11, b18, b26, b34,   0,   0,   0]
        [ 0,  0,  0,  b3,  b6, b11, b18, b26, b34,   0,   0]
        [ 0,  0,  0,   0,  b3,  b6, b11, b18, b26, b34,   0]
        [ 0,  0,  0,   0,   0,  b3,  b6, b11, b18, b26, b34]]';
 
 
Mat7 = [[  0, a3, a6, a11, a18, a27,   0,   0,   0,   0,   0]
        [  0,  0, a3,  a6, a11, a18, a27,   0,   0,   0,   0]
        [  0,  0,  0,  a3,  a6, a11, a18, a27,   0,   0,   0]
        [  0,  0,  0,   0,  a3,  a6, a11, a18, a27,   0,   0]
        [  0,  0,  0,   0,   0,  a3,  a6, a11, a18, a27,   0]
        [  0,  0,  0,   0,   0,   0,  a3,  a6, a11, a18, a27]
        [ b1, b2, b5, b10, b17, b25, b33,   0,   0,   0,   0]
        [  0, b1, b2,  b5, b10, b17, b25, b33,   0,   0,   0]
        [  0,  0, b1,  b2,  b5, b10, b17, b25, b33,   0,   0]
        [  0,  0,  0,  b1,  b2,  b5, b10, b17, b25, b33,   0]
        [  0,  0,  0,   0,  b1,  b2,  b5, b10, b17, b25, b33]]';
 
 
Mat8 = [[ a1, a2, a5, a10, a17, a26,   0,   0,   0,   0,   0]
        [  0, a1, a2,  a5, a10, a17, a26,   0,   0,   0,   0]
        [  0,  0, a1,  a2,  a5, a10, a17, a26,   0,   0,   0]
        [  0,  0,  0,  a1,  a2,  a5, a10, a17, a26,   0,   0]
        [  0,  0,  0,   0,  a1,  a2,  a5, a10, a17, a26,   0]
        [  0,  0,  0,   0,   0,  a1,  a2,  a5, a10, a17, a26]
        [  0,  0,  0,   0,   0,   0,   0,   0,   0,   0,   0]
        [  0,  0,  0,   0,   0,   0,   0,   0,   0,   0,   0]
        [  0,  0,  0,   0,   0,   0,   0,   0,   0,   0,   0]
        [  0,  0,  0,   0,   0,   0,   0,   0,   0,   0,   0]
        [  0,  0,  0,   0,   0,   0,   0,   0,   0,   0,   0]]';

% %polynomial eigenvalue factorization
% [YYY XXX] = polyeig(Mat0,Mat1,Mat2,Mat3,Mat4,Mat5,Mat6,Mat7,Mat8);
% I = find(abs(imag(XXX))<1e-6);
% ttemp = real(XXX(I))+1; %due to translation
% YYY = real(YYY(:,I));
% YYY = YYY(1:9,:)./YYY(2:10,:);
% ftemp = median(YYY,1)';
% 
% % t in the interval [0.1,100]
% % f in the interval [0.1,1000]
% Index = (ttemp>0.1).*(ttemp<100).*(ftemp>0.1).*(ftemp<1000);
% 
% ttemp = ttemp(Index>0.5);
% ftemp = ftemp(Index>0.5);
% 

Mat{1} = Mat1; Mat{2} = Mat2; Mat{3} = Mat3; Mat{4} = Mat4;
Mat{5} = Mat5; Mat{6} = Mat6; Mat{7} = Mat7; Mat{8} = Mat8; 

A = eye(11*8);
A(1:11,1:11) = Mat0;
B = diag(ones(11*(8-1),1),-11);
j = 1:11;
for k = 1:8
    B(1:11,j) = - Mat{k};
    j = j+11;
end
% XX = eig(A,B);
% %find the real eigenvalue
% I = find(not(imag(XX)));
% ftemp2 = XX(I);
% 

AA = A([1:83],[1:83]); BB = B([1:83],[1:83]);
[YYY XXX] = eig(AA.',BB.');
%find the real eigenvalue
XXX = diag(XXX);
I = find(abs(imag(XXX))<1e-6);
ttemp = real(XXX(I)); 
YYY = real(YYY(:,I));
YYY = YYY(1:9,:)./YYY(2:10,:);
ftemp = median(YYY,1).';
%ftemp = (YYY(1,:)./YYY(2,:)).';
end
