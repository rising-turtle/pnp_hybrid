% Generated using GBSolver generator v1.1 Copyright Martin Bujnak,
% Zuzana Kukelova, Tomas Pajdla CTU Prague 2008.
% 
% Please refer to the following paper, when using this code :
%     Kukelova Z., Bujnak M., Pajdla T., Automatic Generator of Minimal Problem Solvers,
%     ECCV 2008, Marseille, France, October 12-18, 2008

function [w b d c meta M] = p4pf_quat2(u11, X11)

    meta = {};
    
	%monomials appearing in matrix M:
	%    c^3*d^2*w c^4*d*w c^5*w b*c*d^3*w b*c^2*d*w^2 b*c^2*d^2*w b*c^3*d*w b*c^4*w b^2*d^3*w b^2*c*d*w^2 b^2*c*d^2*w 
	%    b^2*c^2*d*w b^2*c^3*w b^3*d*w^2 b^3*d^2*w b^3*c*d*w b^3*c^2*w b^4*d*w b^4*c*w b^5*w c*d^2*w^2 c*d^3*w 
	%    c*d^4 c^2*d*w^2 c^2*d^2*w c^2*d^3 c^3*w^2 c^3*d*w c^3*d^2 c^4*w c^4*d c^5 b*d^2*w^2 
	%    b*d^3*w b*d^4 b*c*d*w^2 b*c*d^2*w b*c*d^3 b*c^2*w^2 b*c^2*d*w b*c^2*d^2 b*c^3*w b*c^3*d b*c^4 
	%    b^2*d*w^2 b^2*d^2*w b^2*d^3 b^2*c*d*w b^2*c*d^2 b^2*c^2*w b^2*c^2*d b^2*c^3 b^3*d*w b^3*d^2 b^3*c*w 
	%    b^3*c*d b^3*c^2 b^4*w b^4*d b^4*c b^5 d^3*w d^4 c*d*w^2 c*d^2*w c*d^3 
	%    c^2*w^2 c^2*d*w c^2*d^2 c^3*w c^3*d c^4 b*d*w^2 b*d^2*w b*d^3 b*c*d*w b*c*d^2 
	%    b*c^2*w b*c^2*d b*c^3 b^2*d*w b^2*d^2 b^2*c*w b^2*c*d b^2*c^2 b^3*w b^3*d b^3*c 
	%    b^4 d^2*w d^3 c*d*w c*d^2 c^2*w c^2*d c^3 b*d*w b*d^2 b*c*w 
	%    b*c*d b*c^2 b^2*w b^2*d b^2*c b^3 d*w d^2 c*w c*d c^2 
	%    b*w b*d b*c b^2 w d c b 1 
	M = zeros(117, 119);
	M([450, 566, 682, 798, 1031, 1147, 1263, 1379, 1612, 1728, 1844, 2077, 3794, 3910, 4143, 4259, 4609, 5193, 5309, 5542, 6126, 8441, 8557, 8790, 9374, 11235]) = 2*u11(4);
	M([2673, 2906, 3022, 3372, 4073, 4306, 4422, 4772, 5356, 5472, 5705, 6289, 7187, 7303, 7536, 7652, 8002, 8586, 8702, 8935, 9519, 10430, 10546, 10779, 11363, 12405]) = u11(4);
	M([2907, 3140, 3256, 3489, 4307, 4540, 4656, 4889, 5589, 5822, 6406, 7421, 7537, 7770, 7886, 8119, 8819, 9052, 9636, 10663, 10896, 11480, 12522]) = -2*u11(4);
	M([3375, 3491, 3607, 3723, 4775, 4891, 5007, 5123, 5824, 5940, 6056, 6640, 7889, 8005, 8121, 8237, 8353, 9054, 9170, 9286, 9870, 10898, 11014, 11130, 11714, 12756]) = u11(4);
	M([4779, 4895, 5011, 5127, 5711, 5827, 5943, 6059, 6409, 6525, 6641, 6991, 8825, 8941, 9057, 9173, 9289, 9639, 9755, 9871, 10221, 11483, 11599, 11715, 12065, 13107]) = 2*u11(3)-2;
	M([5715, 5831, 5947, 6063, 6296, 6412, 6528, 6644, 6760, 6876, 6992, 7108, 9410, 9526, 9642, 9758, 9874, 9990, 10106, 10222, 10338, 11834, 11950, 12066, 12182, 13224]) = -u11(4);
	M([7704, 7937, 8053, 8286, 8753, 8869, 8985, 9218, 9451, 9567, 9800, 10150, 10463, 10579, 10695, 10811, 11044, 11277, 11393, 11626, 11976, 12302, 12418, 12651, 13001, 13458]) = 2*u11(3)-2;
	M([10863, 10979, 11095, 11211, 11444, 11560, 11676, 11792, 11908, 12024, 12140, 12256, 12335, 12451, 12567, 12683, 12799, 12915, 13031, 13147, 13263, 13355, 13471, 13587, 13703, 13809]) = -u11(4);
	M([107, 223, 573, 806, 1156, 1272, 1388, 1855, 2399, 2515, 2748, 2864, 3214, 4149, 4265, 4615, 5550, 7392, 7508, 7858, 8793, 10651]) = 2*u11(6)*X11(8);
	M([692, 808, 1158, 1391, 1624, 1740, 1856, 2089, 3803, 3919, 4152, 4268, 4618, 5202, 5318, 5551, 6135, 8445, 8561, 8794, 9378, 11236]) = 2*u11(6)*X11(7);
	M([3032, 3382, 4317, 4784, 5368, 5484, 5717, 6301, 7196, 7312, 7545, 7661, 8011, 8595, 8711, 8944, 9528, 10434, 10550, 10783, 11367, 12406]) = u11(6)+X11(8);
	M([3266, 3499, 4551, 4901, 5601, 5834, 6418, 7430, 7546, 7779, 7895, 8128, 8828, 9061, 9645, 10667, 10900, 11484, 12523]) = -2*u11(6)*X11(7);
	M([3617, 3733, 4902, 5135, 5836, 5952, 6068, 6652, 7898, 8014, 8130, 8246, 8362, 9063, 9179, 9295, 9879, 10902, 11018, 11134, 11718, 12757]) = u11(6)-X11(8);
	M([4670, 4903, 5837, 6186, 6419, 6769, 8483, 8599, 8831, 9064, 9413, 9646, 9996, 11252, 11485, 11835, 12874]) = 2*u11(6)*X11(8);
	M([5021, 5137, 5838, 6071, 6421, 6537, 6653, 7003, 8834, 8950, 9066, 9182, 9298, 9648, 9764, 9880, 10230, 11487, 11603, 11719, 12069, 13108]) = 2*u11(3)/u11(4)*u11(6)-2*X11(7);
	M([5957, 6073, 6423, 6656, 6772, 6888, 7004, 7120, 9419, 9535, 9651, 9767, 9883, 9999, 10115, 10231, 10347, 11838, 11954, 12070, 12186, 13225]) = -u11(6)+X11(8);
	M([8063, 8296, 8880, 9230, 9463, 9579, 9812, 10162, 10472, 10588, 10704, 10820, 11053, 11286, 11402, 11635, 11985, 12306, 12422, 12655, 13005, 13459]) = 2*u11(3)/u11(4)*u11(6)-2*X11(7);
	M([11105, 11221, 11571, 11804, 11920, 12036, 12152, 12268, 12344, 12460, 12576, 12692, 12808, 12924, 13040, 13156, 13272, 13359, 13475, 13591, 13707, 13810]) = -u11(6)-X11(8);
	M([111, 695, 1279, 1746, 2645, 2878, 2994, 3344, 4045, 4278, 4394, 4744, 5328, 5444, 5677, 6261, 7167, 7283, 7516, 7632, 7982, 8566, 8682, 8915, 9499, 10422, 10538, 10771, 11355, 12403]) = u11(6)*X11(7)-X11(8)*u11(5)-u11(6);
	M([345, 929, 1513, 1980, 3347, 3463, 3579, 3695, 4747, 4863, 4979, 5095, 5796, 5912, 6028, 6612, 7869, 7985, 8101, 8217, 8333, 9034, 9150, 9266, 9850, 10890, 11006, 11122, 11706, 12754]) = u11(6)*X11(7)+X11(8)*u11(5)-u11(6);
	M([930, 1514, 1981, 2214, 4751, 4867, 4983, 5099, 5683, 5799, 5915, 6031, 6381, 6497, 6613, 6963, 8805, 8921, 9037, 9153, 9269, 9619, 9735, 9851, 10201, 11475, 11591, 11707, 12057, 13105]) = -2*u11(6)*X11(8)-2*u11(3)/u11(4)*u11(6)+2*X11(7)*u11(5);
	M([1515, 1982, 2215, 2331, 5687, 5803, 5919, 6035, 6268, 6384, 6500, 6616, 6732, 6848, 6964, 7080, 9390, 9506, 9622, 9738, 9854, 9970, 10086, 10202, 10318, 11826, 11942, 12058, 12174, 13222]) = -u11(6)*X11(7)-X11(8)*u11(5)+u11(6);
	M([3270, 4673, 5608, 6192, 7676, 7909, 8025, 8258, 8725, 8841, 8957, 9190, 9423, 9539, 9772, 10122, 10443, 10559, 10675, 10791, 11024, 11257, 11373, 11606, 11956, 12294, 12410, 12643, 12993, 13456]) = 2*X11(7)*u11(5)+2*u11(6)*X11(8)-2*u11(3)/u11(4)*u11(6);
	M([8184, 9119, 9703, 10053, 10835, 10951, 11067, 11183, 11416, 11532, 11648, 11764, 11880, 11996, 12112, 12228, 12315, 12431, 12547, 12663, 12779, 12895, 13011, 13127, 13243, 13347, 13463, 13579, 13695, 13807]) = X11(8)*u11(5)-u11(6)*X11(7)+u11(6);
	M([117, 467, 700, 1050, 1283, 1750, 2418, 2534, 2884, 3819, 3935, 4285, 5337, 7170, 7520, 8572, 10418]) = u11(8)*X11(12);
	M([234, 701, 817, 1284, 1400, 1867, 2769, 2885, 3235, 4170, 4286, 4636, 5571, 7521, 7871, 8806, 10652]) = 2*u11(8)*X11(11);
	M([351, 818, 934, 1401, 1517, 1984, 3120, 3236, 3469, 4521, 4637, 4870, 5805, 7872, 8105, 9040, 10886]) = -u11(8)*X11(12);
	M([819, 1286, 1402, 1752, 1868, 2101, 4173, 4289, 4639, 5223, 5339, 5572, 6156, 8574, 8807, 9391, 11237]) = 2*u11(8)*X11(10);
	M([1521, 1871, 1987, 2103, 2219, 2335, 5576, 5809, 6158, 6391, 6741, 9393, 9626, 9976, 11822]) = -u11(8)*X11(12);
	M([3393, 4445, 4795, 5496, 5729, 6313, 7566, 7682, 8032, 8616, 8732, 8965, 9549, 10563, 10796, 11380, 12407]) = u11(8)+X11(11);
	M([3510, 4679, 4912, 5613, 5846, 6430, 7800, 7916, 8149, 8849, 9082, 9666, 10680, 10913, 11497, 12524]) = -2*u11(8)*X11(10);
	M([3627, 4796, 5029, 5730, 5963, 6547, 7917, 8033, 8266, 8850, 8966, 9199, 9783, 10797, 11030, 11614, 12641]) = -2*X11(12);
	M([3744, 5030, 5146, 5964, 6080, 6664, 8151, 8267, 8383, 9084, 9200, 9316, 9900, 11031, 11147, 11731, 12758]) = -X11(11)+u11(8);
	M([4914, 5615, 5848, 6198, 6431, 6781, 8852, 9085, 9434, 9667, 10017, 11265, 11498, 11848, 12875]) = 2*u11(8)*X11(11);
	M([5148, 5966, 6082, 6549, 6665, 7015, 9087, 9203, 9319, 9669, 9785, 9901, 10251, 11616, 11732, 12082, 13109]) = -2*X11(10)+2*u11(3)/u11(4)*u11(8);
	M([6084, 6551, 6667, 6900, 7016, 7132, 9672, 9788, 9904, 10020, 10136, 10252, 10368, 11967, 12083, 12199, 13226]) = X11(11)-u11(8);
	M([8190, 8891, 9124, 9474, 9707, 10057, 10724, 10957, 11306, 11539, 11889, 12318, 12551, 12901, 13343]) = u11(8)*X11(12);
	M([8307, 9008, 9241, 9591, 9824, 10174, 10725, 10841, 11074, 11307, 11423, 11656, 12006, 12435, 12668, 13018, 13460]) = -2*X11(10)+2*u11(3)/u11(4)*u11(8);
	M([9360, 9827, 9943, 10176, 10292, 10408, 11544, 11660, 11776, 11892, 12008, 12124, 12240, 13020, 13136, 13252, 13694]) = 2*X11(12);
	M([11232, 11699, 11815, 12048, 12164, 12280, 12597, 12713, 12829, 12945, 13061, 13177, 13293, 13488, 13604, 13720, 13811]) = -X11(11)-u11(8);
	M([3012, 3362, 4297, 4413, 4763, 5347, 5463, 5696, 6280, 7178, 7528, 7644, 7994, 8578, 8694, 8927, 9511, 10426, 10542, 10775, 11359, 12404]) = -u11(7)*X11(11)-u11(8)+u11(8)*X11(10);
	M([3363, 3596, 4648, 4764, 4997, 5581, 5697, 5930, 6514, 7529, 7879, 7995, 8228, 8812, 8928, 9161, 9745, 10660, 10776, 11009, 11593, 12638]) = 2*u11(7)*X11(12);
	M([3597, 3713, 4882, 4998, 5114, 5815, 5931, 6047, 6631, 7880, 8113, 8229, 8345, 9046, 9162, 9278, 9862, 10894, 11010, 11126, 11710, 12755]) = u11(8)*X11(10)+u11(7)*X11(11)-u11(8);
	M([4767, 5000, 5584, 5700, 5933, 6166, 6282, 6515, 6865, 8582, 8815, 8931, 9164, 9397, 9513, 9746, 10096, 11245, 11361, 11594, 11944, 12989]) = -2*u11(8)*X11(12);
	M([5001, 5117, 5818, 5934, 6050, 6400, 6516, 6632, 6982, 8816, 9049, 9165, 9281, 9631, 9747, 9863, 10213, 11479, 11595, 11711, 12061, 13106]) = -2*u11(8)*X11(11)+2*u11(7)*X11(10)-2*u11(3)/u11(4)*u11(8);
	M([5937, 6053, 6403, 6519, 6635, 6751, 6867, 6983, 7099, 9401, 9634, 9750, 9866, 9982, 10098, 10214, 10330, 11830, 11946, 12062, 12178, 13223]) = -u11(8)*X11(10)-u11(7)*X11(11)+u11(8);
	M([8043, 8276, 8860, 8976, 9209, 9442, 9558, 9791, 10141, 10454, 10687, 10803, 11036, 11269, 11385, 11618, 11968, 12298, 12414, 12647, 12997, 13457]) = 2*u11(7)*X11(10)+2*u11(8)*X11(11)-2*u11(3)/u11(4)*u11(8);
	M([8277, 8393, 9094, 9210, 9326, 9676, 9792, 9908, 10258, 10688, 10921, 11037, 11153, 11503, 11619, 11735, 12085, 12532, 12648, 12764, 13114, 13574]) = -2*u11(8)*X11(12);
	M([9213, 9329, 9679, 9795, 9911, 10027, 10143, 10259, 10375, 11273, 11506, 11622, 11738, 11854, 11970, 12086, 12202, 12883, 12999, 13115, 13231, 13691]) = -2*u11(7)*X11(12);
	M([11085, 11201, 11551, 11667, 11783, 11899, 12015, 12131, 12247, 12326, 12559, 12675, 12791, 12907, 13023, 13139, 13255, 13351, 13467, 13583, 13699, 13808]) = u11(7)*X11(11)+u11(8)-u11(8)*X11(10);

	Mr = rref(M);  % replace me with a MEX

	A = zeros(2);
	amcols = [119 118];
	A(1, :) = -Mr(115, amcols);
	A(2, :) = -Mr(111, amcols);

	% generated for action variable 'w'
	% action matrix monomials: 1 b
	[V D] = eig(A);
	sol =  V([2],:)./(ones(1, 1)*V(1,:));

	if (find(isnan(sol(:))) > 0)
		
		w = [];
		d = [];
		c = [];
		b = [];
	else
		
		ev  = diag(D);
		I = find(not(imag( sol(1,:) )) & not(imag( ev ))' & (ev > 0)');
		w = ev(I);
		b = sol(1,I);
        
        c = - Mr(end, end)   - b*Mr(end, end-1);
        d = - Mr(end-1, end) - b*Mr(end-1, end-1);
	end
end

%{
w d c b 1 
1 0 0 * *
  1 0 * *
    1 * *
%}    
    
    