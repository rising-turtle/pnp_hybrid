% Generated using GBSolver generator v1.1 Copyright Martin Bujnak,
% Zuzana Kukelova, Tomas Pajdla CTU Prague 2008.
% 
% Please refer to the following paper, when using this code :
%     Kukelova Z., Bujnak M., Pajdla T., Automatic Generator of Minimal Problem Solvers,
%     ECCV 2008, Marseille, France, October 12-18, 2008

function [a3 a1 a2 meta M] = mbp4pf_np_7015(Pa1, Pb1, Pc1, Pd1)

	% instance=pfpf_DAC_nullspace_inst gbordering={a3,a2,a1} solverordering={a3,a1,a2} equations={} basis={1,a3,a3*a1,a2,a2*a1,a1,a1^2,a1^3} 
	% gj = 0
	meta = {0, {'pfpf_DAC_nullspace_inst'}, {'a3' 'a1' 'a2'}, {'a3' 'a2' 'a1'}, {}, {'1' 'a3' 'a3*a1' 'a2' 'a2*a1' 'a1' 'a1^2' 'a1^3'} };

	%monomials appearing in matrix M:
	%    a1*a3^3 a1^2*a3^2 a1^3*a3 a1^4 a2*a3^3 a2*a1*a3^2 a2*a1^2*a3 a2*a1^3 a2^2*a3^2 a2^2*a1*a3 a2^2*a1^2 
	%    a2^3*a3 a2^3*a1 a2^4 a3^3 a1*a3^2 a1^2*a3 a1^3 a2*a3^2 a2*a1*a3 a2*a1^2 a2^2*a3 
	%    a2^2*a1 a2^3 a3^2 a1*a3 a1^2 a2*a3 a2*a1 a2^2 a3 a1 a2 
	%    1 
	M = zeros(30, 34);
	M([21, 50, 139, 168, 257, 427, 456, 545, 721]) = Pc1(2)^2+Pc1(3)^2+Pc1(1)^2-Pc1(7)^2-Pc1(5)^2-Pc1(6)^2;
	M([51, 80, 169, 198, 287, 457, 486, 575, 751]) = 2*Pa1(2)*Pc1(2)+2*Pa1(3)*Pc1(3)-2*Pa1(5)*Pc1(5)-2*Pc1(6)*Pa1(6)-2*Pc1(7)*Pa1(7)+2*Pa1(1)*Pc1(1);
	M([81, 110, 199, 228, 317, 487, 516, 605, 781]) = -Pa1(7)^2+Pa1(2)^2+Pa1(3)^2+Pa1(1)^2-Pa1(5)^2-Pa1(6)^2;
	M([171, 200, 259, 288, 347, 547, 576, 635, 811]) = 2*Pc1(1)*Pb1(1)+2*Pc1(3)*Pb1(3)-2*Pc1(5)*Pb1(5)-2*Pb1(6)*Pc1(6)-2*Pc1(7)*Pb1(7)+2*Pc1(2)*Pb1(2);
	M([201, 230, 289, 318, 377, 577, 606, 665, 841]) = 2*Pa1(3)*Pb1(3)-2*Pa1(5)*Pb1(5)-2*Pb1(6)*Pa1(6)-2*Pb1(7)*Pa1(7)+2*Pa1(1)*Pb1(1)+2*Pa1(2)*Pb1(2);
	M([291, 320, 349, 378, 407, 637, 666, 695, 871]) = Pb1(1)^2+Pb1(2)^2+Pb1(3)^2-Pb1(5)^2-Pb1(6)^2-Pb1(7)^2;
	M([471, 500, 559, 588, 647, 727, 756, 815, 901]) = -2*Pd1(6)*Pc1(6)-2*Pd1(7)*Pc1(7)+2*Pd1(2)*Pc1(2)+2*Pd1(1)*Pc1(1)+2*Pd1(3)*Pc1(3)-2*Pd1(5)*Pc1(5);
	M([501, 530, 589, 618, 677, 757, 786, 845, 931]) = 2*Pd1(1)*Pa1(1)+2*Pa1(2)*Pd1(2)+2*Pa1(3)*Pd1(3)-2*Pa1(5)*Pd1(5)-2*Pd1(6)*Pa1(6)-2*Pd1(7)*Pa1(7);
	M([591, 620, 649, 678, 707, 817, 846, 875, 961]) = 2*Pd1(1)*Pb1(1)+2*Pd1(2)*Pb1(2)+2*Pd1(3)*Pb1(3)-2*Pd1(5)*Pb1(5)-2*Pb1(6)*Pd1(6)-2*Pd1(7)*Pb1(7);
	M([771, 800, 829, 858, 887, 907, 936, 965, 991]) = Pd1(2)^2+Pd1(3)^2-Pd1(5)^2-Pd1(6)^2-Pd1(7)^2+Pd1(1)^2;
	M([26, 55, 144, 173, 262, 430, 459, 548, 722]) = Pc1(7)*Pc1(3)+Pc1(5)*Pc1(1)+Pc1(6)*Pc1(2);
	M([56, 85, 174, 203, 292, 460, 489, 578, 752]) = Pa1(7)*Pc1(3)+Pc1(2)*Pa1(6)+Pa1(2)*Pc1(6)+Pc1(5)*Pa1(1)+Pc1(7)*Pa1(3)+Pa1(5)*Pc1(1);
	M([86, 115, 204, 233, 322, 490, 519, 608, 782]) = Pa1(2)*Pa1(6)+Pa1(5)*Pa1(1)+Pa1(3)*Pa1(7);
	M([176, 205, 264, 293, 352, 550, 579, 638, 812]) = Pb1(6)*Pc1(2)+Pb1(7)*Pc1(3)+Pc1(6)*Pb1(2)+Pc1(5)*Pb1(1)+Pb1(5)*Pc1(1)+Pc1(7)*Pb1(3);
	M([206, 235, 294, 323, 382, 580, 609, 668, 842]) = Pa1(7)*Pb1(3)+Pb1(6)*Pa1(2)+Pa1(6)*Pb1(2)+Pb1(7)*Pa1(3)+Pb1(5)*Pa1(1)+Pa1(5)*Pb1(1);
	M([296, 325, 354, 383, 412, 640, 669, 698, 872]) = Pb1(7)*Pb1(3)+Pb1(5)*Pb1(1)+Pb1(6)*Pb1(2);
	M([476, 505, 564, 593, 652, 730, 759, 818, 902]) = Pc1(7)*Pd1(3)+Pd1(7)*Pc1(3)+Pd1(6)*Pc1(2)+Pd1(1)*Pc1(5)+Pc1(6)*Pd1(2)+Pd1(5)*Pc1(1);
	M([506, 535, 594, 623, 682, 760, 789, 848, 932]) = Pd1(2)*Pa1(6)+Pd1(5)*Pa1(1)+Pd1(7)*Pa1(3)+Pa1(5)*Pd1(1)+Pa1(2)*Pd1(6)+Pa1(7)*Pd1(3);
	M([596, 625, 654, 683, 712, 820, 849, 878, 962]) = Pd1(6)*Pb1(2)+Pd1(1)*Pb1(5)+Pd1(7)*Pb1(3)+Pb1(6)*Pd1(2)+Pb1(7)*Pd1(3)+Pd1(5)*Pb1(1);
	M([776, 805, 834, 863, 892, 910, 939, 968, 992]) = Pd1(1)*Pd1(5)+Pd1(6)*Pd1(2)+Pd1(7)*Pd1(3);
	M([60, 149, 178, 267, 433, 462, 551, 723]) = Pc1(11)*Pc1(3)+Pc1(1)*Pc1(9)+Pc1(10)*Pc1(2);
	M([90, 179, 208, 297, 463, 492, 581, 753]) = Pa1(9)*Pc1(1)+Pa1(11)*Pc1(3)+Pa1(2)*Pc1(10)+Pa1(10)*Pc1(2)+Pa1(1)*Pc1(9)+Pa1(3)*Pc1(11);
	M([120, 209, 238, 327, 493, 522, 611, 783]) = Pa1(9)*Pa1(1)+Pa1(3)*Pa1(11)+Pa1(2)*Pa1(10);
	M([210, 269, 298, 357, 553, 582, 641, 813]) = Pb1(10)*Pc1(2)+Pc1(9)*Pb1(1)+Pb1(9)*Pc1(1)+Pc1(11)*Pb1(3)+Pb1(11)*Pc1(3)+Pc1(10)*Pb1(2);
	M([240, 299, 328, 387, 583, 612, 671, 843]) = Pa1(10)*Pb1(2)+Pa1(3)*Pb1(11)+Pa1(11)*Pb1(3)+Pa1(9)*Pb1(1)+Pa1(2)*Pb1(10)+Pb1(9)*Pa1(1);
	M([330, 359, 388, 417, 643, 672, 701, 873]) = Pb1(9)*Pb1(1)+Pb1(11)*Pb1(3)+Pb1(10)*Pb1(2);
	M([510, 569, 598, 657, 733, 762, 821, 903]) = Pd1(2)*Pc1(10)+Pd1(11)*Pc1(3)+Pd1(3)*Pc1(11)+Pd1(1)*Pc1(9)+Pd1(9)*Pc1(1)+Pd1(10)*Pc1(2);
	M([540, 599, 628, 687, 763, 792, 851, 933]) = Pd1(1)*Pa1(9)+Pd1(9)*Pa1(1)+Pa1(2)*Pd1(10)+Pd1(3)*Pa1(11)+Pd1(2)*Pa1(10)+Pa1(3)*Pd1(11);
	M([630, 659, 688, 717, 823, 852, 881, 963]) = Pd1(10)*Pb1(2)+Pd1(1)*Pb1(9)+Pd1(3)*Pb1(11)+Pd1(9)*Pb1(1)+Pd1(11)*Pb1(3)+Pd1(2)*Pb1(10);
	M([810, 839, 868, 897, 913, 942, 971, 993]) = Pd1(1)*Pd1(9)+Pd1(2)*Pd1(10)+Pd1(3)*Pd1(11);
	M([436, 465, 554, 724]) = Pc1(6)*Pc1(10)+Pc1(5)*Pc1(9)+Pc1(7)*Pc1(11);
	M([466, 495, 584, 754]) = Pc1(10)*Pa1(6)+Pa1(5)*Pc1(9)+Pc1(6)*Pa1(10)+Pa1(9)*Pc1(5)+Pc1(7)*Pa1(11)+Pa1(7)*Pc1(11);
	M([496, 525, 614, 784]) = Pa1(5)*Pa1(9)+Pa1(10)*Pa1(6)+Pa1(7)*Pa1(11);
	M([556, 585, 644, 814]) = Pb1(9)*Pc1(5)+Pb1(6)*Pc1(10)+Pc1(6)*Pb1(10)+Pb1(5)*Pc1(9)+Pb1(7)*Pc1(11)+Pc1(7)*Pb1(11);
	M([586, 615, 674, 844]) = Pa1(7)*Pb1(11)+Pb1(7)*Pa1(11)+Pb1(10)*Pa1(6)+Pb1(6)*Pa1(10)+Pa1(5)*Pb1(9)+Pa1(9)*Pb1(5);
	M([646, 675, 704, 874]) = Pb1(9)*Pb1(5)+Pb1(6)*Pb1(10)+Pb1(7)*Pb1(11);
	M([736, 765, 824, 904]) = Pd1(6)*Pc1(10)+Pd1(9)*Pc1(5)+Pc1(6)*Pd1(10)+Pc1(7)*Pd1(11)+Pd1(7)*Pc1(11)+Pd1(5)*Pc1(9);
	M([766, 795, 854, 934]) = Pa1(7)*Pd1(11)+Pd1(10)*Pa1(6)+Pa1(5)*Pd1(9)+Pd1(7)*Pa1(11)+Pd1(6)*Pa1(10)+Pd1(5)*Pa1(9);
	M([826, 855, 884, 964]) = Pd1(6)*Pb1(10)+Pb1(9)*Pd1(5)+Pd1(7)*Pb1(11)+Pb1(6)*Pd1(10)+Pb1(7)*Pd1(11)+Pd1(9)*Pb1(5);
	M([916, 945, 974, 994]) = Pd1(9)*Pd1(5)+Pd1(6)*Pd1(10)+Pd1(7)*Pd1(11);

	Mr = rref(M);  % replace me with a MEX

	A = zeros(8);
	amcols = [34 33 32 31 29 27 26 18];
	A(1, 4) = 1;
	A(2, :) = -Mr(28, amcols);
	A(3, 7) = 1;
	A(4, :) = -Mr(25, amcols);
	A(5, :) = -Mr(20, amcols);
	A(6, :) = -Mr(17, amcols);
	A(7, :) = -Mr(16, amcols);
	A(8, :) = -Mr(3, amcols);

	% generated for action variable 'a3'
	% action matrix monomials: 1 a2 a1 a3 a2*a1 a1^2 a3*a1 a1^3
	[V D] = eig(A);
    
    nonzero = find( abs(V(1,:)) > eps);
    
	sol =  V([4, 3, 2],nonzero)./(ones(3, 1)*V(1,nonzero));

	if (find(isnan(sol(:))) > 0)
		
		a3 = [];
		a1 = [];
		a2 = [];
	else
		
		I = find(not(imag( sol(1,:) )));
		a3 = sol(1,I);
		a1 = sol(2,I);
		a2 = sol(3,I);
	end
end
